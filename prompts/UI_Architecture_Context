# EProductSnippet Plugin - UI Architecture Context

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞–≥–∏–Ω–∞
Figma-–ø–ª–∞–≥–∏–Ω –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫–µ—Ç–æ–≤ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ HTML/MHTML —Ñ–∞–π–ª–æ–≤ (Yandex search results).

---

## üìÅ –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã UI

### –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª UI
**`src/ui.tsx`** - React 18 –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å state machine:
- **States:** `idle` ‚Üí `loading` ‚Üí `completed`
- **Tabs:** `import` | `settings` | `logs`
- **Key states:** `uiState`, `activeTab`, `progress`, `stats`, `logs`

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Import Tab
```
src/components/
‚îú‚îÄ‚îÄ DropZone.tsx              - Drag & drop —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ import/
‚îÇ   ‚îú‚îÄ‚îÄ LiveProgressView.tsx  - –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (thinking style)
‚îÇ   ‚îî‚îÄ‚îÄ CompletionCard.tsx    - –†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ Header.tsx                - –¢–∞–±—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ ScopeControl.tsx          - Selection/Page –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
‚îú‚îÄ‚îÄ settings/SettingsView.tsx - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞
‚îî‚îÄ‚îÄ logs/LogsView.tsx         - –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
```

### –°—Ç–∏–ª–∏
**`src/styles.css`** - Figma UI3 native —Å—Ç–∏–ª–∏:
- CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `--figma-color-*`
- –¢–µ–º—ã: dark (default) + light
- –ö–ª—é—á–µ–≤—ã–µ –∫–ª–∞—Å—Å—ã: `.drop-zone`, `.thinking-status`, `.completion-status`

---

## üîÑ –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è UI ‚Üî Code

### –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –ø–ª–∞–≥–∏–Ω (UI ‚Üí Code)
```typescript
import { sendMessageToPlugin } from './utils/plugin-bridge';

sendMessageToPlugin({
  type: 'import-csv',
  rows: CSVRow[],
  scope: 'selection' | 'page'
});
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç –ø–ª–∞–≥–∏–Ω–∞ (Code ‚Üí UI)
```typescript
// –í ui.tsx useEffect:
window.onmessage = (event) => {
  const msg = event.data.pluginMessage as PluginMessage;
  
  switch (msg.type) {
    case 'progress': // { current, total, operationType }
    case 'stats':    // { processedInstances, successfulImages, failedImages, errors }
    case 'done':     // { count }
    case 'log':      // { message }
    case 'error':    // { message }
  }
};
```

### –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π (`src/types.ts`)
```typescript
type UIMessage = 
  | { type: 'import-csv'; rows: CSVRow[]; scope: string }
  | { type: 'get-settings' }
  | { type: 'save-settings'; settings: UserSettings }
  | { type: 'get-parsing-rules' }
  | { type: 'check-remote-rules-update' }
  // ... –∏ –¥—Ä—É–≥–∏–µ

type CodeMessage = 
  | { type: 'progress'; current: number; total: number }
  | { type: 'stats'; stats: ProcessingStats }
  | { type: 'done'; count: number }
  | { type: 'log'; message: string }
  | { type: 'error'; message: string }
  // ... –∏ –¥—Ä—É–≥–∏–µ
```

---

## üé® UI State Machine

### –°–æ—Å—Ç–æ—è–Ω–∏—è Import Tab
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ IDLE                                                ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ DropZone (–±–æ–ª—å—à–æ–π, 120px)                       ‚îÇ ‚îÇ
‚îÇ ‚îÇ "Click or drag HTML file"                       ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ üí° Tip: Supports HTML & MHTML files...              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚îÇ Drop file / Select file
          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ LOADING                                             ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ DropZone (–∫–æ–º–ø–∞–∫—Ç–Ω—ã–π, disabled)                 ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ ‚Ä¢ ‚Ä¢ ‚Ä¢  Processing...                                ‚îÇ
‚îÇ ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë  5 of 10 ‚Ä¢ 2.3 MB ‚Ä¢ 50%       ‚îÇ
‚îÇ üìÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω MHTML —Ñ–∞–π–ª                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚îÇ msg.type === 'done'
          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ COMPLETED                                           ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ DropZone (–∫–æ–º–ø–∞–∫—Ç–Ω—ã–π, –∞–∫—Ç–∏–≤–Ω—ã–π –¥–ª—è –Ω–æ–≤–æ–≥–æ)      ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ ‚úì Done    8 items ‚Ä¢ 16 images ‚Ä¢ 1.2s               ‚îÇ
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ
‚îÇ √ó Row 13: Failed to load image                      ‚îÇ
‚îÇ View logs   Clear                                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
```typescript
// –ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏
setUiState('loading');
setIsLoading(true);

// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
if (msg.type === 'done') {
  setUiState('completed');
  setIsLoading(false);
}

// –°–±—Ä–æ—Å (Import Another)
const handleImportAnother = () => {
  setUiState('idle');
  setStats(null);
  setProgress(null);
};
```

---

## üîß DropZone Props

```typescript
interface DropZoneProps {
  isDragOver: boolean;      // –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –ø—Ä–∏ drag
  onDragOver: (e) => void;
  onDragLeave: (e) => void;
  onDrop: (e) => void;
  onFileSelect: (e) => void;
  compact?: boolean;        // true –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
  disabled?: boolean;       // true –ø—Ä–∏ loading –∏–ª–∏ –Ω–µ—Ç selection
  fullscreen?: boolean;     // true –ø—Ä–∏ drag –≤ idle —Å–æ—Å—Ç–æ—è–Ω–∏–∏
}
```

**–õ–æ–≥–∏–∫–∞ –≤ ui.tsx:**
```typescript
<DropZone
  compact={uiState !== 'idle'}
  disabled={(scope === 'selection' && !hasSelection) || uiState === 'loading'}
  fullscreen={(isDragging || isDragOver) && uiState === 'idle'}
/>
```

---

## üìä ProcessingStats Interface

```typescript
interface ProcessingStats {
  processedInstances: number;  // –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ items
  totalInstances: number;
  successfulImages: number;    // –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  skippedImages: number;       // –ü—Ä–æ–ø—É—â–µ–Ω–æ (—É–∂–µ –µ—Å—Ç—å)
  failedImages: number;        // –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
  errors?: DetailedError[];    // –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫
}

interface DetailedError {
  id: string;
  type: 'image' | 'text' | 'font' | 'other';
  message: string;
  layerName?: string;
  rowIndex?: number;           // –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
  url?: string;                // URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
}
```

---

## üõ† –°–±–æ—Ä–∫–∞

```bash
# –ü–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞
npm run build
# = rollup -c && node add-polyfill.js && node embed-ui.js

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# dist/code.js        - Backend (ES5)
# dist/ui-embedded.html - Frontend —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —Å—Ç–∏–ª—è–º–∏
```

**–í–∞–∂–Ω–æ:**
- `code.js` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å ES5 (Figma Plugin API)
- UI —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ –æ–¥–∏–Ω HTML —Ñ–∞–π–ª
- –°—Ç–∏–ª–∏ –≤—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ HTML

---

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **ES5 –≤ code.js** - –Ω–∏–∫–∞–∫–∏—Ö async/await, arrow functions –≤ –∏—Ç–æ–≥–æ–≤–æ–º –∫–æ–¥–µ
2. **–ù–µ—Ç Node.js API** –≤ —Ä–∞–Ω—Ç–∞–π–º–µ –ø–ª–∞–≥–∏–Ω–∞
3. **–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ postMessage**
4. **–®–∏—Ä–∏–Ω–∞ –æ–∫–Ω–∞** ~280-400px
5. **Figma-native —Å—Ç–∏–ª–∏** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

---

## üéØ –¢–µ–∫—É—â–∏–µ UX —Ñ–∏—á–∏

1. **Auto-scroll logs** - LogsView –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä–æ–ª–ª–∏—Ç—Å—è –∫ –Ω–æ–≤—ã–º –∑–∞–ø–∏—Å—è–º
2. **Processing time** - –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
3. **File size display** - –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
4. **Error row numbers** - –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫ –≤ –æ—à–∏–±–∫–∞—Ö
5. **Disable DropZone** - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ selection
6. **File size warnings** - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –¥–ª—è —Ñ–∞–π–ª–æ–≤ >10MB
7. **Minimal status design** - ChatGPT-style —Å—Ç–∞—Ç—É—Å—ã

---

## üìù –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∫–æ–¥–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∞
```typescript
const addLog = useCallback((message: string) => {
  const timestamp = new Date().toLocaleTimeString();
  setLogs(prev => [...prev, `[${timestamp}] ${message}`]);
}, []);
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞
```typescript
const processFiles = async (files: FileList) => {
  setUiState('loading');
  setProcessingStartTime(Date.now());
  
  const file = files[0];
  setCurrentFileSize(file.size);
  
  // –ü–∞—Ä—Å–∏–Ω–≥ HTML/MHTML
  const result = parseYandexSearchResults(htmlContent);
  
  // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –ø–ª–∞–≥–∏–Ω
  sendMessageToPlugin({
    type: 'import-csv',
    rows: result.rows,
    scope: scope
  });
};
```

### Keyboard shortcuts
```typescript
useEffect(() => {
  const handleKeyDown = (e: KeyboardEvent) => {
    if (e.key === '1') setActiveTab('import');
    if (e.key === '2') setActiveTab('settings');
    if (e.key === '3') setActiveTab('logs');
    if (e.key === 'o' && (e.metaKey || e.ctrlKey)) {
      document.getElementById('file-input')?.click();
    }
  };
  window.addEventListener('keydown', handleKeyDown);
  return () => window.removeEventListener('keydown', handleKeyDown);
}, []);
```

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- **`src/code.ts`** - Backend –ª–æ–≥–∏–∫–∞ –ø–ª–∞–≥–∏–Ω–∞ (Figma API)
- **`src/types.ts`** - TypeScript —Ç–∏–ø—ã
- **`src/utils/plugin-bridge.ts`** - –£—Ç–∏–ª–∏—Ç—ã –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
- **`src/utils/mhtml-parser.ts`** - –ü–∞—Ä—Å–∏–Ω–≥ MHTML
- **`src/utils/snippet-parser.ts`** - –ü–∞—Ä—Å–∏–Ω–≥ HTML snippets
- **`manifest.json`** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–ª–∞–≥–∏–Ω–∞

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π UI

1. **–ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç** –≤ `src/components/`
2. **–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∏–ª–∏** –≤ `src/styles.css`
3. **–°–æ–±—Ä–∞—Ç—å:** `npx rollup -c && node embed-ui.js`
4. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–ª–∞–≥–∏–Ω** –≤ Figma

**–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π state machine:**
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `src/ui.tsx`
- –°–ª–µ–¥–∏—Ç—å –∑–∞ —Ç–∏–ø–∞–º–∏ –≤ `src/types.ts`
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π

