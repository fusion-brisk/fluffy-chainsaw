# –ö–æ–Ω—Ç–µ–∫—Å—Ç: –ö–Ω–æ–ø–∫–∞ "–ö—É–ø–∏—Ç—å –≤ 1 –∫–ª–∏–∫" (MarketCheckoutButton)

## –¶–µ–ª—å
–ü–∞—Ä—Å–∏–Ω–≥ HTML –Ø–Ω–¥–µ–∫—Å-–≤—ã–¥–∞—á–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ª–∏—á–∏—è –∫–Ω–æ–ø–∫–∏ "–ö—É–ø–∏—Ç—å –≤ 1 –∫–ª–∏–∫" –≤ —Å–Ω–∏–ø–ø–µ—Ç–∞—Ö –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Variant Property `BUTTON=true/false` –≤ Figma-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö.

---

## HTML-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–Ω–æ–ø–∫–∏

```html
<div class="Root" id="MarketCheckoutButtonBase__6uety3r22c4xyr800p0q-PhOk6S40" data-state-id="...">
  <a target="_blank" 
     href="https://market.yandex.ru/my/cart?osku=..." 
     data-market-url-type="market_checkout" 
     data-counter="[&quot;b&quot;]" 
     data-log-node="..." 
     type="button" 
     class="Button Button_size_m Button_weight_normal Button_pin_circle-circle Button_link Button_view_primary MarketCheckout-Button" 
     autocomplete="off">
    <span class="Button-Text">
      <span class="Icon2 Icon2_mask Icon2_size_14 MarketCheckout-Icon" 
            style="...-webkit-mask-image:url(&quot;//yastatic.net/.../Checkout_14....svg&quot;);...">
      </span>
      –ö—É–ø–∏—Ç—å –≤ 1 –∫–ª–∏–∫
    </span>
  </a>
</div>
```

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∏:
| –ü—Ä–∏–∑–Ω–∞–∫ | –°–µ–ª–µ–∫—Ç–æ—Ä | –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å |
|---------|----------|------------|
| data-–∞—Ç—Ä–∏–±—É—Ç | `[data-market-url-type="market_checkout"]` | ‚≠ê‚≠ê‚≠ê –°–∞–º—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π |
| –ö–ª–∞—Å—Å –∫–Ω–æ–ø–∫–∏ | `.MarketCheckout-Button` | ‚≠ê‚≠ê‚≠ê –ù–∞–¥—ë–∂–Ω—ã–π |
| ID –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ | `[id^="MarketCheckoutButtonBase__"]` | ‚≠ê‚≠ê –ù–∞–¥—ë–∂–Ω—ã–π |
| –¢–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ | `.Button-Text` + "–ö—É–ø–∏—Ç—å –≤ 1 –∫–ª–∏–∫" | ‚≠ê Fallback |

---

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã

```typescript
// src/parsing-rules.ts ‚Üí MarketCheckoutButton
domSelectors: [
  '[data-market-url-type="market_checkout"]',
  '.MarketCheckout-Button',
  '[class*="MarketCheckout-Button"]',
  '[id^="MarketCheckoutButtonBase__"]',
  '[id*="MarketCheckoutButton"]'
]
```

---

## –§–∞–π–ª—ã –∏ –ª–æ–≥–∏–∫–∞

### 1. –ü–∞—Ä—Å–∏–Ω–≥ HTML ‚Üí `src/utils/snippet-parser.ts`

```typescript
// –°—Ç—Ä–æ–∫–∏ ~810-830
const marketCheckoutSelectors = rules['MarketCheckoutButton']?.domSelectors || [...];
const marketCheckoutBtn = queryFirstMatch(cache, marketCheckoutSelectors);

if (marketCheckoutBtn) {
  row['#BUTTON'] = 'true';
} else {
  // Fallback: –∏—â–µ–º –ø–æ —Ç–µ–∫—Å—Ç—É "–ö—É–ø–∏—Ç—å –≤ 1 –∫–ª–∏–∫"
  const buttonTextEl = container.querySelector('.Button-Text');
  if (buttonTextEl && buttonTextEl.textContent?.includes('–ö—É–ø–∏—Ç—å –≤ 1 –∫–ª–∏–∫')) {
    row['#BUTTON'] = 'true';
  } else {
    row['#BUTTON'] = 'false';
  }
}
```

### 2. –ü—Ä–∞–≤–∏–ª–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞
- `src/parsing-rules.ts` ‚Äî TypeScript –≤–µ—Ä—Å–∏—è
- `config/parsing-rules.json` ‚Äî JSON –≤–µ—Ä—Å–∏—è (–¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)

### 3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ Figma ‚Üí `src/component-handlers.ts`

```typescript
// –§—É–Ω–∫—Ü–∏—è handleMarketCheckoutButton()
export function handleMarketCheckoutButton(context: HandlerContext): void {
  const hasButton = row['#BUTTON'] === 'true';
  
  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º BUTTON variant property
  processVariantProperty(instance, `BUTTON=${hasButton}`, '#BUTTON');
  // Fallback –≤–∞—Ä–∏–∞–Ω—Ç—ã: Button=, button=
}
```

### 4. –í—ã–∑–æ–≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ ‚Üí `src/code.ts`

```typescript
// –°—Ç—Ä–æ–∫–∞ ~525
handleMarketCheckoutButton(context); // –ö–Ω–æ–ø–∫–∞ "–ö—É–ø–∏—Ç—å –≤ 1 –∫–ª–∏–∫"
```

---

## Figma-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç

### ESnippet —Å –∫–Ω–æ–ø–∫–æ–π:
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –±–ª–æ–∫ "Button" –≤–Ω—É—Ç—Ä–∏ "Price Block"
- Variant Property: `BUTTON` (boolean: true/false)
- –ü—Ä–∏ `BUTTON=true` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "–ö—É–ø–∏—Ç—å –≤ 1 –∫–ª–∏–∫"
- –ü—Ä–∏ `BUTTON=false` –∫–Ω–æ–ø–∫–∞ —Å–∫—Ä—ã—Ç–∞

### –í–∏–∑—É–∞–ª—å–Ω—ã–π –≤–∏–¥ –∫–Ω–æ–ø–∫–∏ –≤ Figma:
- –¶–≤–µ—Ç: `#F8604A` (–æ—Ä–∞–Ω–∂–µ–≤–æ-–∫—Ä–∞—Å–Ω—ã–π)
- –§–æ—Ä–º–∞: pill (rounded-full)
- –ò–∫–æ–Ω–∫–∞: –∫–æ—Ä–∑–∏–Ω–∞ (Checkout_14.svg)
- –¢–µ–∫—Å—Ç: "–ö—É–ø–∏—Ç—å –≤ 1 –∫–ª–∏–∫"

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### HTML-—Ñ–∞–π–ª –¥–ª—è —Ç–µ—Å—Ç–æ–≤:
```
examples/iphone17.html
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏ –≤ HTML:
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ Chrome DevTools:
document.querySelectorAll('[data-market-url-type="market_checkout"]').length
document.querySelectorAll('.MarketCheckout-Button').length
document.querySelectorAll('[id^="MarketCheckoutButtonBase__"]').length
```

### –û–∂–∏–¥–∞–µ–º—ã–π –ª–æ–≥ –ø–ª–∞–≥–∏–Ω–∞:
```
‚úÖ –ù–∞–π–¥–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ö—É–ø–∏—Ç—å –≤ 1 –∫–ª–∏–∫" –≤ —Å–Ω–∏–ø–ø–µ—Ç–µ "–°–º–∞—Ä—Ç—Ñ–æ–Ω Apple iPhone 17..."
üõí [BUTTON] BUTTON=true –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ "ESnippet"
```

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ö–Ω–æ–ø–∫–∞ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ HTML —Å–æ–¥–µ—Ä–∂–∏—Ç `data-market-url-type="market_checkout"`
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–Ω–∏–ø–ø–µ—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å ‚Äî –∫–Ω–æ–ø–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–Ω–∏–ø–ø–µ—Ç–∞

### 2. Variant Property –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º—è —Å–≤–æ–π—Å—Ç–≤–∞ –≤ Figma (BUTTON, Button, button)
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî —ç—Ç–æ Instance, –∞ –Ω–µ Frame/Group

### 3. –ö–Ω–æ–ø–∫–∞ –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ DOM
- MarketCheckoutButton –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å–Ω–∏–ø–ø–µ—Ç–æ–≤
- –ù—É–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å `findSnippetContainers()` –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫

---

## Chrome MCP ‚Äî –ø–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```javascript
// –ù–∞–π—Ç–∏ –≤—Å–µ —Å–Ω–∏–ø–ø–µ—Ç—ã —Å –∫–Ω–æ–ø–∫–æ–π
Array.from(document.querySelectorAll('[class*="Organic"], [class*="EProductSnippet2"], .EShopItem'))
  .filter(el => el.querySelector('[data-market-url-type="market_checkout"]'))
  .length

// –ò–∑–≤–ª–µ—á—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–Ω–æ–ø–∫–∞—Ö
Array.from(document.querySelectorAll('[data-market-url-type="market_checkout"]'))
  .map(btn => ({
    href: btn.href,
    text: btn.textContent.trim(),
    parentSnippet: btn.closest('[class*="Organic"], [class*="EProductSnippet2"], .EShopItem')?.className
  }))
```

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –ø–æ–ª—è CSVRow

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `#BUTTON` | string | 'true' / 'false' ‚Äî –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏ |

---

## –°–±–æ—Ä–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –°–±–æ—Ä–∫–∞ –ø–ª–∞–≥–∏–Ω–∞
npm run build

# –§–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
# - dist/code.js ‚Äî –ª–æ–≥–∏–∫–∞ –ø–ª–∞–≥–∏–Ω–∞
# - dist/ui.html ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```

