# –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—Ä—ë—Ö —ç—Ç–∞–ø–æ–≤ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ (`Refactor_Stage1_Quick_Wins`, `Refactor_Stage2_Split_Functions`, `Refactor_Stage3_Tests_Cleanup`) –ø–ª–∞–≥–∏–Ω Contentify —Å—Ç–∞–ª –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —á–∏—â–µ:

- ‚úÖ –ö—ç—à —Å–≤–æ–π—Å—Ç–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω (O(1) –æ—á–∏—Å—Ç–∫–∞)
- ‚úÖ `processVariantProperty` —Å–æ–∫—Ä–∞—â–µ–Ω–∞ —Å 275 –¥–æ 60 —Å—Ç—Ä–æ–∫
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã helper-—Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ –ù–æ–≤—ã–π API: `trySetProperty`, `trySetVariantProperty`, `trySetVariantPropertyRecursive`
- ‚úÖ –ë–∞–Ω–¥–ª —É–º–µ–Ω—å—à–∏–ª—Å—è –Ω–∞ ~18 KB (4%)

## –¶–µ–ª—å —ç—Ç–æ–≥–æ —á–∞—Ç–∞

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ —Ä–∞–±–æ—Ç—ã –ø–ª–∞–≥–∏–Ω–∞ –∏ –Ω–∞–π—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
1. Bottlenecks –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
3. –ú–µ—Å—Ç–∞ —Å –≤—ã—Å–æ–∫–∏–º O(n¬≤) –∏–ª–∏ —Ö—É–∂–µ
4. –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Figma API

---

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. –ó–∞–ø—É—Å—Ç–∏ –ø–ª–∞–≥–∏–Ω –≤ Figma –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º –º–∞–∫–µ—Ç–µ
2. –û—Ç–∫—Ä–æ–π –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (Developer Tools ‚Üí Console)
3. –°–∫–æ–ø–∏—Ä—É–π –ª–æ–≥–∏ —Ä–∞–±–æ—Ç—ã –ø–ª–∞–≥–∏–Ω–∞
4. –í—Å—Ç–∞–≤—å –ª–æ–≥–∏ –≤ —ç—Ç–æ—Ç —á–∞—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

---

## –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö

### 1. –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∞–ø–æ–≤

```
‚è±Ô∏è –ó–∞–≥—Ä—É–∑–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤: X.XXs
‚è±Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤: X.XXs
‚è±Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: X.XXs
```

–ö–∞–∫–æ–π —ç—Ç–∞–ø –∑–∞–Ω–∏–º–∞–µ—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏?

### 2. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—ç—à–∞

```
üìä [PropCache] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (SYNC):
   - –ó–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤: N
   - –í—Å–µ–≥–æ lookups: M
   - Cache hits: K (XX%)
   - Cache misses: L
```

–ù–∏–∑–∫–∏–π hit rate (< 80%) ‚Äî –ø—Ä–∏–∑–Ω–∞–∫ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—ç—à–∞.

### 3. –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –æ–ø–µ—Ä–∞—Ü–∏–∏

```
‚úÖ [trySetProperty] View=large (#View)
‚úÖ [trySetProperty] View=large (#View)  ‚Üê –¥—É–±–ª—å?
```

–ï—Å–ª–∏ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —Å–≤–æ–π—Å—Ç–≤–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ ‚Äî –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å.

### 4. –û—à–∏–±–∫–∏ –∏ warnings

```
‚ö†Ô∏è –°–≤–æ–π—Å—Ç–≤–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:
   "PropertyName" –≤ ComponentType: 15√ó
```

–ß–∞—Å—Ç—ã–µ warnings = –ª–∏—à–Ω–∏–µ –ø–æ–ø—ã—Ç–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–≤–æ–π—Å—Ç–≤.

### 5. –î–æ–ª–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

```
üñºÔ∏è [ImageHandler] –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è... (–Ω–∞—á–∞–ª–æ)
...–º–Ω–æ–≥–æ –¥—Ä—É–≥–∏—Ö –ª–æ–≥–æ–≤...
üñºÔ∏è [ImageHandler] –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (–∫–æ–Ω–µ—Ü)
```

–ë–æ–ª—å—à–æ–π gap –º–µ–∂–¥—É –Ω–∞—á–∞–ª–æ–º –∏ –∫–æ–Ω—Ü–æ–º = bottleneck.

---

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–®—Ä–∏—Ñ—Ç—ã**: `figma.loadFontAsync()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ?
2. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏–ª–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ?
3. **findInstanceByName**: —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–æ–∏—Å–∫ –Ω–∞ –∫–∞–∂–¥—ã–π –≤—ã–∑–æ–≤?
4. **–û–±—Ö–æ–¥ –¥–µ—Ä–µ–≤–∞**: —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –æ–±—Ö–æ–¥–∏–º –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ?
5. **setProperties**: batch –∏–ª–∏ –ø–æ –æ–¥–Ω–æ–º—É?

### –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
code.ts (entry)
‚îú‚îÄ‚îÄ handlers/ (component-specific logic)
‚îÇ   ‚îú‚îÄ‚îÄ label-handlers.ts
‚îÇ   ‚îú‚îÄ‚îÄ button-handlers.ts
‚îÇ   ‚îú‚îÄ‚îÄ price-handlers.ts
‚îÇ   ‚îú‚îÄ‚îÄ delivery-handlers.ts
‚îÇ   ‚îî‚îÄ‚îÄ snippet-handlers.ts
‚îú‚îÄ‚îÄ text-handlers.ts (text layers processing)
‚îú‚îÄ‚îÄ image-handlers.ts (image loading & applying)
‚îú‚îÄ‚îÄ property-utils.ts (property setting with cache)
‚îî‚îÄ‚îÄ utils/
    ‚îú‚îÄ‚îÄ component-cache.ts (property cache)
    ‚îú‚îÄ‚îÄ node-search.ts (tree traversal)
    ‚îî‚îÄ‚îÄ container-search.ts (container finding)
```

---

## –§–æ—Ä–º–∞—Ç –∞–Ω–∞–ª–∏–∑–∞

–ü–æ—Å–ª–µ –≤—Å—Ç–∞–≤–∫–∏ –ª–æ–≥–æ–≤, –∞–Ω–∞–ª–∏–∑ –±—É–¥–µ—Ç –≤–∫–ª—é—á–∞—Ç—å:

1. **–ü—Ä–æ—Ñ–∏–ª—å –≤—Ä–µ–º–µ–Ω–∏**: –≥–¥–µ —Ç—Ä–∞—Ç–∏—Ç—Å—è –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
2. **Hotspots**: –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –æ–ø–µ—Ä–∞—Ü–∏–∏
3. **Recommendations**: –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
4. **Implementation Plan**: –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## –ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

```
üìù –ó–∞–≥—Ä—É–∂–∞–µ–º —à—Ä–∏—Ñ—Ç—ã –¥–ª—è 156 —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–ª–æ–µ–≤...
üî§ –ù–∞–π–¥–µ–Ω–æ 12 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —à—Ä–∏—Ñ—Ç–æ–≤
‚úÖ –®—Ä–∏—Ñ—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: 12, –æ—à–∏–±–æ–∫: 0 (234ms)
‚è±Ô∏è –ó–∞–≥—Ä—É–∑–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤: 0.23s

üìù –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º 156 —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–ª–æ–µ–≤...
üîç [Text Layer] –û–±–Ω–∞—Ä—É–∂–µ–Ω —Ñ–æ—Ä–º–∞—Ç Variant Property: "View=large"
   ‚úÖ [trySetVariant] View=large (#View)
...
‚è±Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤: 1.45s

üñºÔ∏è –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º 45 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...
‚è±Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 8.23s  ‚Üê BOTTLENECK!

üìä [PropCache] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (SYNC):
   - –ó–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤: 234
   - –í—Å–µ–≥–æ lookups: 1567
   - Cache hits: 1245 (79.5%)
   - Cache misses: 322
```

---

## –ì–æ—Ç–æ–≤ –∫ –∞–Ω–∞–ª–∏–∑—É

–í—Å—Ç–∞–≤—å –ª–æ–≥–∏ —Ä–∞–±–æ—Ç—ã –ø–ª–∞–≥–∏–Ω–∞, –∏ —è –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –∏—Ö –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π.


